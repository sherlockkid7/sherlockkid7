---
title: 2020年9月份工作小结
date: 2020-10-11 20:41:55
tags: 随记
categories: 工作
---

这个月主要写了三个项目的页面，但是其中两个都是有头无尾，这两个其中一个是使用H5写的页面，后台调用数据；第二个是uniapp写的页面，数据是另一个前端在调用，感觉根本学不到啥东西，纯粹的前端切图仔。第三个又是政府项目，还要做到11月份，想想都可悲。

还是简单总结下这个月工作中遇到的难题。

#### 1.控制根元素字号

```js
(function (doc, win) {
    var docEl = doc.documentElement;
    var resizeEvt = 'orientationchange' in window ?
        'orientationchange' :
        'resize';

    function recalc() {
        var clientWidth = docEl.clientWidth;
        if (!clientWidth) return;
        if (clientWidth >= 750) {
            docEl.style.fontSize = '100px';
        } else {
            docEl.style.fontSize = 100 * (clientWidth / 750) + 'px';
        }
    };

    if (!doc.addEventListener) return;

    win.addEventListener(resizeEvt, recalc, false);
    doc.addEventListener('DOMContentLoaded', recalc, false);
})(document, window);

//对比
(function (doc, win) {
    var docEl = doc.documentElement;

    var resizeEvt = 'orientationchange' in window ?
        'orientationchange' :
    'resize';

    function recalc() {
        var clientWidth = docEl.clientWidth;
        if (!clientWidth) return;
        if (clientWidth > 1200 ) {
            docEl.style.fontSize = "14px";
        } else if(clientWidth >= 750){
            docEl.style.fontSize = '100px';
        }else{
            docEl.style.fontSize = 100 * (clientWidth / 750) + 'px';
        }
    };

    if (!doc.addEventListener) return;

    win.addEventListener(resizeEvt, recalc, false);
    doc.addEventListener('DOMContentLoaded', recalc, false);
 })(document, window);
```

#### 2.控制菜单点击有二级菜单出现二级菜单，如无，点击跳转链接地址 

```js
var cwidth = document.documentElement.clientWidth;
    if (cwidth < 1200) {
        $(".webitem").each(function () {
        var len = $(this).find(".map-list-con a").length;
        if (len > 0) {
            var maplink = $(this).find('.twolist');

            maplink.click(function () {
            var num = parseInt($(this).attr("data-num")) + 1;

            $(this).attr("data-num", num);
            if (num == 2) {
            window.location.href = $(this).attr("m-href");
            } else {
                $(this).attr("m-href", '')
            }
            })
        } else {
            var href = $(this).find('.twolist').attr("m-href");
            $(this).find('.twolist').attr('href', href);
        }
        })
    } else {
        $(".webitem").each(function () {
        var href = $(this).find('.twolist').attr("m-href");
        $(this).find('.twolist').attr('href', href);

    })

}
```

#### 3.控制二级菜单显示隐藏，获取当前页面某元素的链接地址以及title,并赋值给二级菜单

```js
$(function(){
    $('.dot').click(function(){
    $(this).find('.two-menu').toggleClass('hidden');
    })
    $("#list-left .left-menu-content").each(function(){
    var url = $(this).attr("data-url");
    var name = $(this).find(".menu-item").attr("title");
    $(".two-menu").append('<a href="'+ url +'">'+ name +'</a>');
    })

})
```

#### 4.使用ajax获取外网资源，并渲染到页面中

```js
$(function(){
GetGWYNews();
});
function GetGWYNews(){
$.ajax({
url: 'http://www.gov.cn/pushinfo/v150203/pushinfo.jsonp',
dataType: "jsonp",
jsonp: "pushInfoJsonpCallBack",
jsonpCallback: "pushInfoJsonpCallBack",
success: function(data) {
    $.each(data, function(i, json) {
    if(i < 8) {
    var title = json.title;
    if(title.length > 20) {
    title = title.substring(0, 20) + "...";
    }
    $("#govnews").append("<li><i></i><a target='_blank' href='" + json.link + "'>" + title + "</a><span>" + json.pubDate + "</span></li>");
    }
    })
},
error: function() {
alert('fail');
}

});
}
```

#### 5.获取当前位置以>分割的第一个词语，如果当前词语与导航栏的菜单栏的词语一致，当前菜单栏显示为激活状态，否则菜单栏第一位为激活状态

```js
$(function () {
    var text = $(".current").text();
    text = text.split('>')[1];
    if (text) {
        // 替换开始的空格和结束的空格为''
        text = text.replace(/^\s+|\s+$/g, "");
        
        $(".nav-list li a").each(function () {
            var txt = $(this).text();
            txt = txt.replace(/^\s+|\s+$/g, "");
            if (txt == text) {
                $(this).parents('li').addClass('active');
            }
        })
    }else {
        // 选中首页
        $('.nav-list li').first().addClass("active");
    }
});
```

#### 6.去除select选择按钮默认样式

```css
appearance:none;
-moz-appearance:none;
-webkit-appearance:none;
background-image:url('//引入的下拉图标');
background-repeat: no-repeat;
background-size: 4%;
background-position: 96%;
```

#### 7.控制多行文本隐藏，省略号显示

```css
//两行文本隐藏省略
.comrow2{
  word-break: break-all;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  overflow: hidden;
}
```

