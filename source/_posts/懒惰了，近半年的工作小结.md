---
title: 懒惰了，近半年的工作小结
date: 2021-03-21 14:19:58
tags: 随记
categories: 工作
---
已经有许久未曾每月总结一下工作了。哎，自己太懒了！工作之后就感觉空闲时间学习是件很困难的事，虽然很想技术提高，却没有学习的方向，动力也不足。其实也该好好制定下计划，不然工作一年之后，啥知识也没学到，换工作也会很吃力吧，加油吧，少年人！

在这期间的工作总结，写了三个政府网站（响应式），一个企业网站（响应式），vue项目（后台管理系统的页面及数据调用、前台静态页面），其它h5页面

2020年10月~2021年3月的工作问题记录

##### 根据特定的字符截取首尾的文字

```js
var localName = $('.current-local span a:nth-of-type(3)').text().trim();

if(localName == '关于我们' || localName == '法律声明' || localName == '使用帮助'|| localName == '首页轮播'){
    var lasturl = $('.current-local span a:nth-of-type(3)').attr('href');
    var firsturl = $('.current-local span a:nth-of-type(1)').attr('href');
    var txt = $('.current-local span').text().split(">");
    $('.current-local span').html('当前位置：'+'<a href="'+firsturl+'">'+txt[1]+'</a>'+'&gt;'+'<a href="'+lasturl+'">'+txt[2]+'</a>');
}
```

##### ajax调用数据

```js
$.ajax({
      url: 'http://jyhpt.tj.gov.cn/zmljl/list?resultDeptType=1&deptID=1002012000000000',

      success: function (data) {

     var items = JSON.parse(data).datas["data"];
    var questionType="";
    var flowStatus = "";
    var ifDelay = "";
    var createTime = "";
      $.each(items, function (i, json) {
    if(i < 5){
    //console.log(json.createTime)

    switch (json.questionType) {
        case (1):
            questionType="咨询"
            break;
        case (2):
            questionType="投诉"
            break;
        case (3):
            questionType="建议"
            break;
        case (4):
            questionType="求助"
            break;
        default:
            questionType=""
    }
    switch (json.flowStatus) {
        case (1):
            flowStatus="待回复"
            break;
        case (2):
            flowStatus="已回复"
            break;

        default:
            questionType=""
    }
    switch (json.ifDelay) {
        case (1):
            ifDelay="未超时"
            break;
        case (2):
            ifDelay="已超时"
            break;

        default:
            questionType=""
    }
    createTime = date('Y-m-d',json.createTime/1000);
    $("#divqzxx").append("<li><a target='_blank' href='http://zw.enorth.com.cn/gov_open/"+json.id+".html'><i>·</i><div class='hdlyr1'>["+questionType+"]</div><div class='hdlyr2'>"+json.title+"</div><div class='hdlyr3'>"+createTime+"</div><div class='hdlyr4'>"+flowStatus+"</div><div class='hdlyr5'>"+ifDelay+"</div></a></li>");


    $("#divqzxx_m").append("<li><a target='_blank' href='http://zw.enorth.com.cn/gov_open/"+json.id+".html' target='_blank'><i></i><p>["+questionType+"]  "+json.title+"</p><span class='time' time=''>"+createTime+"</span></a></li>");
      }
      })
      },
      error: function () {
      	console.log('fail');
      }
      });
  });
```

```js
$.ajax({
    url : 'http://jyhpt.tj.gov.cn/zmljl/list?resultDeptType=1&pageIndex='+page+'&pageSize=10&deptID=1002011000000000&_='+Math.random(),
    dataType : "json",
    success : function(data) {
        if(data.statusCode==200)
        {
            $.each(data.datas.data,function(i,json){

                var questionTypeStr = json.questionType;
                if(questionTypeStr==1)questionTypeStr="咨询";
                else if(questionTypeStr==2)questionTypeStr="投诉";
                else if(questionTypeStr==3)questionTypeStr="建议";
                else if(questionTypeStr==4)questionTypeStr="求助";

                var flowStatusStr = json.flowStatus;
                if(flowStatusStr==1)flowStatusStr="未回复";
                else if(flowStatusStr==2)flowStatusStr="已回复";

                var ifDelayStr = json.ifDelay;
                if(ifDelayStr==1)ifDelayStr="未超时";
                else if(ifDelayStr==2)ifDelayStr="已超时";
                if(page==1 || (page==2 && i<2))
                    $("#zmljl").append('<li><span class="lb">'+questionTypeStr+'</span><span class="lb1"><a target="_blank" href="index_17705.html?id='+json.id+'">'+json.title+'</a></span><span class="lb data">'+formatDate(json.createTime)+'</span><span class="lb">'+flowStatusStr+'</span><span class="lb">'+ifDelayStr+'</span></li>');
            });
        }
        else
        {
            //alert('数据加载失败');
        }
    },
    error:function(){
        //alert('数据加载失败');
    }
});
```

##### 点击下拉箭头，加载更多列表

```html
<div class="article-list phide">
    <ul class="js-blog-list">
    </ul>
    <div class="arrow-next js-load-more">
        <img src="./images/new-arrowmore.png" alt="">
    </div>
</div>
```

```js
$(function(){
    /*初始化*/
    var counter = 0; /*计数器*/
    var pageStart = 0; /*offset 当前列表*/
    var pageSize = 4; /*size 相当于每页的个数 */

    /*首次加载*/
    getData(pageStart, pageSize);

    /*监听加载更多*/
    $(document).on('click', '.js-load-more', function(){
        counter ++;
        pageStart = counter * pageSize;
        getData(pageStart, pageSize);
    });
});

function getData(offset,size){
    $.ajax({
        type: 'GET',
        url: './images/test.json',
        dataType: 'json',
        success: function(reponse){
            var data = reponse.list;
            var sum = reponse.list.length;
            var result = '';
            /****业务逻辑块：实现拼接html内容并append到页面*********/
            //console.log(offset , size, sum);
            
            /*如果剩下的记录数不够分页，就让分页数取剩下的记录数
            * 例如分页数是5，只剩2条，则只取2条
            *
            * 实际MySQL查询时不写这个不会有问题
            */
            if(sum - offset < size ){
                size = sum - offset;
            }

            /*使用for循环模拟SQL里的limit(offset,size)*/
            for(var i=offset; i< (offset+size); i++){
                result +='<li>'+'<a href="">'+'<img src="" data-src="'+ data[i].pic +'" alt="" class="object-cover"><div class="title">'+data[i].title +'</div></a></li>';
            }
            $('.js-blog-list').html(result);
            /*******************************************/

            /*隐藏more按钮*/
            if ( (offset + size) >= sum){
                $(".js-load-more").hide();
            }else{
                $(".js-load-more").show();
            }
        },
        error: function(xhr, type){
            alert('Ajax error!');
        }
    });
}
```

##### 显示日期（实现每秒改变）

```html
<div class="left" id="currentNow">
<!-- 2020-09-01  09:39:40:00  星期二 -->
</div>
```

```js
$(function() {
	now();
    setInterval("now()",1000);
})
function now(){
  var date = new Date();
  var year = date.getFullYear();
  var mouth = date.getMonth() + 1;
  var day = date.getDate();
  var hh = (date.getHours() < 10 ? '0' + date.getHours() : date.getHours()) + ':';
  var mm = (date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes()) + ':';
  var ss = (date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds());
  if(mouth < 10) {
      mouth = "0" + mouth;
  }
  if(day < 10) {
      day = "0" + day;
  }

  var str= '星期'+'日一二三四五六'.charAt(new Date().getDay());
  var nowDate = year + "-" + mouth + "-" + day + " " +" " + hh + mm + ss + " " +" "+ str;
    $('#currentNow').text(nowDate);
}

```

##### 根据后台获取的数据，实现分页 (没理解透彻)

```js
$(function(){
    getZmCon();
});
/**时间戳转换**/
function formatDate(date) {
    var date = new Date(date);
    var YY = date.getFullYear() + '-';
    var MM = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
    var DD = (date.getDate() < 10 ? '0' + (date.getDate()) : date.getDate());
    var hh = (date.getHours() < 10 ? '0' + date.getHours() : date.getHours()) + ':';
    var mm = (date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes()) + ':';
    var ss = (date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds());
    return YY + MM + DD;
}
  

var cache = cacheData();
function getZmCon(page){
    var page = parseInt(page) || 1;
    console.log(page);
    $.ajax({
        url : 'http://jyhpt.tj.gov.cn/zmljl/list?resultDeptType=1&deptID=1002018000000000&pageIndex='+page+'&pageSize=10',
        dataType : "json",
        success : function(data) {
            if(data.statusCode==200){
                cache.set(page,data);
                renderData(data);
                var countPage =  data.datas.pageInfo.totalPages;
                var totalNum =  data.datas.pageInfo.totalResults;
                var currentPage = page;
                var prevPage = currentPage - 1;
                var nextPage = currentPage + 1;
                var content = "";
                if (countPage === 1) {
                    $('.page-center').css('display','none')
                }
                content+= "<a  class='firstPage'>首页</a><a  id='prevPage'>上一页</a>"
                if (countPage > 4) {
                    // 1、当前页码小于3且总页码大于4 省略号显示后面+总页码
                    if (currentPage < 3) {
                        // 1与4主要看要显示多少个按钮 目前都显示3个
                        for (var i = 1; i < 4; i++) {
                            if (currentPage !== i) {
                                content+="<a>" + i + "</a>";
                            } else {
                                content+="<a class='active'>" + i + "</a>";
                            }
                        }
                        content+="<span>.&nbsp;.&nbsp;.</span>";
                        content+="<a>" + countPage + "</a>";
                    } else {
                        // 2、当前页码接近后面 到最后页码隔3个 省略号显示后面+总页面
                        if (currentPage < countPage - 3) {
                            for (var i = currentPage - 2; i < currentPage + 2; i++) {
                                if (currentPage !== i) {
                                    content+="<a>" + i + "</a>";
                                } else {
                                    content+="<a class='active'>" + i + "</a>";
                                }
                            }
                            content+=". . .";
                            content+="<a>" + countPage + "</a>";
                        } else {
                            // 3、页码至少在5，最多在【totalNum - 3】的中间位置 第一页+省略号显示前面
                            content+="<a>" + 1 + "</a>";
                            content+=". . .";
                            for (var i = countPage -3; i < countPage + 1; i++) {
                                if (currentPage !== i) {
                                    content+="<a >" + i + "</a>";
                                } else {
                                    content+="<a class='active'>" + i + "</a>";
                                }
                            }
                        }
                    }
                } else {
                    // 总页数小于6
                    for (var i = 1; i < countPage + 1; i++) {
                        if (currentPage !== i) {
                            content+="<a>" + i + "</a>";
                        } else {
                            content+="<a class='active'>" + i + "</a>";
                        }
                    }
                }
                content+="<a id='nextPage'>下一页</a><a id='lastPage'>尾页</a>";
                content+="<font>直接到第&nbsp;<input type='text' id='num' value=" + currentPage+" />&nbsp;页" +"&nbsp;<input type='submit' class='pageSub' value='确定' /></font>";
                // content+="&nbsp;共&nbsp;<b>" + totalNum + "</b>&nbsp;条,";
                content+="&nbsp;共&nbsp;<b>" + countPage + "</b>&nbsp;页";
                $('#page').html(content);

                $('.firstPage').click(function(){
                    getZmCon(1);
                })
                $('#lastPage').click(function(){
                    getZmCon(countPage);
                })
                // $('.prevPage').click(function(){
                //   var num = $(this).text().trim();
                //   if(num>1){
                //     getZmCon(num--);
                //   }

                // })
                // $('#nextPage').click(function(){
                //   var num = $(this).text().trim();
                //   if(num<countPage){
                //     getZmCon(num++);
                //   }

                // })
                $('#page a').click(function(){
                    var num = parseInt($(this).text().trim());
                    var id = $(this).attr('id');
                    // console.log(num)
                    if (id === 'prevPage') {
                        if (currentPage !== 1) {
                            currentPage -= 1;
                            getZmCon(currentPage);
                        }
                    }else if (id === 'nextPage') {
                        if (currentPage !== countPage) {
                            currentPage += 1;
                            getZmCon(currentPage);
                        }
                    } else{
                        getZmCon(num);
                    } 
                })
                $('.pageSub').click(function() {
                    var _num = document.getElementById("num").value;
                    if (isNaN(_num) || _num.indexOf('.')>0 || _num < 0) {
                        alert("请输入大于0的整数");
                        return false;
                    }

                    if (_num < 1 ) {
                        alert("没有当前页码，需要跳转到第一页吗");
                    } 
                    if (_num <= 1 || _num == null) {
                        location.href = url + "index" + "." + "html";
                    } 
                    else if (_num > countPage)
                        alert("超过最大页数" + countPage);
                    else{
                        getZmCon(_num);
                    }
                })

            }else
            {
                // alert('数据加载失败');
            }
        },
        error:function(){
            //  alert('数据加载失败');
        }

    });
}
function cacheData(){
    var cache = {};
    return {
        set:function(page,doc){
            cache[page] = doc;
        },
        get:function(page){
            if(page in cache){
                renderData(cache[page])
            }else{
                getZmCon(page);
            }
        }
    }
}
function renderData(data){
    var str = '';
    var mstr=''
    $.each(data.datas.data,function(i,json){

        var questionTypeStr = json.questionType;
        if(questionTypeStr==1)questionTypeStr="咨询";
        else if(questionTypeStr==2)questionTypeStr="投诉";
        else if(questionTypeStr==3)questionTypeStr="建议";
        else if(questionTypeStr==4)questionTypeStr="求助";

        var flowStatusStr = json.flowStatus;
        if(flowStatusStr==1)flowStatusStr="未回复";
        else if(flowStatusStr==2)flowStatusStr="已回复";

        var ifDelayStr = json.ifDelay;
        if(ifDelayStr==1)ifDelayStr="未超时";
        else if(ifDelayStr==2)ifDelayStr="已超时";

        str += '<div class="row"><span class="wid14">'+questionTypeStr +'</span> <a class="wid40 overflow color-active">' + json.title + '</a><span class="wid16">' + formatDate(json.createTime) + '</span><span class="wid14">' + flowStatusStr + '</span><span class="wid12">' + ifDelayStr  + '</span></div>';
        $('#hd-box').html(str);

        mstr +='<div class="row"><span >'+formatDate(json.createTime) +'</span><span >'+flowStatusStr+'</span><span >'+ifDelayStr+'</span></div>';
        $('#mhd-box').html(mstr);
    });
}

```

##### 判断是否是微信环境，弹出提示框

```js
var pop = document.getElementById("pop");
var downBtn = document.getElementById("downBtn");
pop.onclick = function(){
    pop.style.display = 'none';
}
downBtn.onclick = function() {
    getIsWxClient ();
}
function getIsWxClient () {
    var ua = navigator.userAgent.toLowerCase();
    if (ua.match(/MicroMessenger/i) == "micromessenger") {
    downBtn.href='javascript:;';
    pop.style.display = 'block';

    }	
    return false;
};
```

##### 锚点动效

```js
$('.spe-menu a').click(function() {
    if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
        var $target = $(this.hash);
        $target = $target.length && $target || $('[name=' + this.hash.slice(1) + ']');
        if ($target.length) {
        var targetOffset = $target.offset().top;
        $('html,body').animate({
            scrollTop: targetOffset
            },'slow');
            return false;
        }
    }
});
```

##### 图片懒加载

```html
<img src="" data-src="./images/mod-bg1.jpg" alt="" class="object-cover">
```

```js
//lazyLoad
start();
$(window).on('scroll', function() {
    start();
})


function start() {
	//.not('[data-isLoaded]')选中已加载的图片不需要重新加载
	$('img').not('[data-isLoaded]').each(function() {
		var $node = $(this)
		if(isShow($node)) {
			loadImg($node)
		}
	})
}

//判断一个元素是不是出现在窗口(视野)
function isShow($node) {
	return $node.offset().top <= $(window).height() + $(window).scrollTop()
}
//加载图片
function loadImg($img) {
	//.attr(值)
	//.attr(属性名称,值)
	$img.attr('src', $img.attr('data-src')) //把data-src的值 赋值给src
	$img.attr('data-isLoaded', 1) //已加载的图片做标记
}
```

##### 自定义select选择按钮，单选按钮

```css
select{
  appearance:none;
  -moz-appearance:none;
  -webkit-appearance:none;
  background: #F3F3F3 url('../image/san-jiao.png');
  background-repeat: no-repeat;
  background-size: 12%;
  background-position: 90%;
    
  border-radius: .1rem;
  -webkit-border-radius: .1rem;
  -moz-border-radius: .1rem;
  -ms-border-radius: .1rem;
  -o-border-radius: .1rem;
  width: 1.4rem;
  height: .65rem;
  line-height: .65rem;
  padding:0 .22rem;
  position: relative;  
}

input[type="radio"]{
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  width: .3rem;
  height:.33rem;
  position: relative;
  outline: none;
  cursor: pointer;
  border-radius:.1rem;
  -webkit-border-radius:.1rem;
  -moz-border-radius:.1rem;
  -ms-border-radius:.1rem;
  -o-border-radius:.1rem;
  margin: 0;
  
}
input[type="radio"]:checked:before{
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%,-50%);
  -webkit-transform: translate(-50%,-50%);
  -moz-transform: translate(-50%,-50%);
  -ms-transform: translate(-50%,-50%);
  -o-transform: translate(-50%,-50%);
  background: #FFF;
  width: .16rem;
  height: 0.16rem;
  border-radius: 50%;
  -webkit-border-radius: 50%;
  -moz-border-radius: 50%;
  -ms-border-radius: 50%;
  -o-border-radius: 50%;
}

```

##### swiper

###### 1.多行滑动的注意点：swiper-slide需要设置高度

```css
.partner .partner-content .swiper-slide{
  height: calc((100% - 20px) / 2);
}
```

###### 2.swiper左右箭头超出滑动区域显示

```html
<div class="support-content">
     <div class="swiper-container support-swiper">
         <div class="swiper-wrapper">
            <div class="swiper-slide same-bg">
                <div class="pic-box">
                    <img src="" alt="" data-src="./img/athour.png" >
                </div>
                <div class="desc">
                    <div class="name">
                        <p>郑喜贺</p>
                        <p class="position f18">导演、作家</p>
                        <p class="f18 txt">寄语：学术研究是枯燥的过程，一起杨帆起航。</p>
                    </div>
                    <div class="icon same-icon"><i></i></div>
                </div>
            </div>
            <div class="swiper-slide same-bg">
                <div class="pic-box">
                    <img src="" alt="" data-src="./img/athour.png" >
                </div>
                <div class="desc">
                    <div class="name">
                        <p>郑喜贺</p>
                        <p class="position f18">导演、作家</p>
                        <p class="f18 txt">寄语：学术研究是枯燥的过程，一起杨帆起航。</p>
                    </div>
                    <div class="icon same-icon"><i></i></div>
                </div>
             </div>
            <div class="swiper-slide same-bg">
                <div class="pic-box">
                    <img src="" alt="" data-src="./img/athour.png" >
                </div>
                <div class="desc">
                    <div class="name">
                        <p>郑喜贺</p>
                        <p class="position f18">导演、作家</p>
                        <p class="f18 txt">寄语：学术研究是枯燥的过程，一起杨帆起航。</p>
                    </div>
                    <div class="icon same-icon"><i></i></div>
                </div>
            </div>
        </div>
    </div>

    </div>
    <!-- Add Arrows -->
    <div class="support-next next">
        <img src="./img/arrow-right2.png" alt="">
    </div>
    <div class="support-prev prev">
        <img src="./img/arrow-left2.png" alt="">
    </div>
	<a href="" class="watch-detail">查看更多 <i></i></a>
</div>
```

##### 表单验证

###### 1.发送验证码

```js
// 发送验证码(真实情况)
$(document).on("click", "#codeBtn", function (e) {
    var element = $('#telNumber');

    if (element.val() === "") {
        oTel_msg.innerHTML='<i></i>手机号不能为空';
        element.focus();
        return false;
    } else if (!element.val().match(/^1[3-9]\d{9}$/)) {
        oTel_msg.innerHTML='<i></i>手机格式错误';
        element.focus();
        return false;
    }
    var that = this;

    $(that).addClass("disabled", true).text("发送中...");
    var data = {event: 'mobilelogin', mobile: element.val()};

    $.ajax({
        url: $(that).data("url"),
        type: 'post',
        dataType: 'json',
        data: data,
        success: function (ret) {
            clearInterval(interval);
            var seconds = 60;
            if (ret.code == 200) {
                var interval = setInterval(function () {
                    seconds--;
                    if (seconds <= 0) {
                        clearInterval(interval);
                        $(that).removeClass("disabled").text("获取验证码");
                    } else {
                        $(that).addClass("disabled").text(seconds + "秒后重发");
                    }
                }, 1000);
            } else {
                oTel_msg.innerHTML='<i></i>验证码发送失败';
                $(that).removeClass("disabled").text('获取验证码');
                return false;
            }
        }, error: function (e) {
            oTel_msg.innerHTML='<i></i>验证码发送失败';
            $(that).removeClass("disabled").text('获取验证码');
            return false;
        }
    });

});
```

##### 图片上传功能

```html
// 图片上传实现步骤
// 通过jquery监听input change事件，这样我们可以获取到上传的图片流信息，从而可以获取到图片的地址、大小、格式以及名称等信息

// 这里创建3个数组，imgName、imgSrc、imgFile分别用于存放上传图片的名称、url地址以及图片流信息
<div class="file">
    <div class="tips">
    <i class="ico-plus">+</i>上传图片，支持jpg/png
    </div>
    <input type="file" name="file"  id="upload" >
    <img id="pic" src="" style="display:none;">
</div>	
```

```css
.file{
    width: 200px;
    height: 100px;
    border: 1px dashed #000;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
}
#upload{
    opacity: 0;
    width: 200px;
    height: 100px;
    position: absolute;
    top: 0;
    left: 0;

}
#pic{

    width: 60%;
    height: 80%;
    object-fit: contain;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%,-50%);
}
```

```js
// getObjectURL方法是一个用于获取本地图片的地址，使用该url可以显示图片
function getObjectURL(file) {
    var url = null ;
    if (window.createObjectURL!=undefined) { // basic
        url = window.createObjectURL(file) ;
    } else if (window.URL!=undefined) { // mozilla(firefox)
        url = window.URL.createObjectURL(file) ;
    } else if (window.webkitURL!=undefined) { // webkit or chrome
        url = window.webkitURL.createObjectURL(file) ;
    }
    return url ;
}
// 控制上传图片大小、格式以及上传数量
$('#upload').on('change',function(){		
    //   if(imgSrc.length==4){
    //   return alert("最多只能上传4张图片");
    // }

    var imgSize = this.files[0].size;  //b
    if(imgSize>1024*1024*1){//1M
        return alert("上传图片不能超过1M");
    }
    if(this.files[0].type != 'image/png' && this.files[0].type != 'image/jpeg' && this.files[0].type != 'image/gif'){
        return alert("图片上传格式不正确");
    }

var objUrl = getObjectURL(this.files[0]) ; //获取图片的路径，该路径不是图片在本地的路径
if (objUrl) {
$("#pic").attr("src", objUrl) ; //将图片路径存入src中，显示出图片
$('.tips').hide();
$('#pic').css('display','block');
}
})
```

##### vue小功能模块（todolist）

```vue
<template>
  <section class="todoapp">
    <header class="header">
      <input type="text" class="new-todo" placeholder="Todo List" 
      autocomplete="off" 
      @keyup.enter="addTodo">
    </header>
    <!-- main section -->
    <section class="main">
      <input type="checkbox"
        id="toggle-all"
        class="toggle-all"
        :checked="allChecked"
        @change="toggleAll({ done: !allChecked })"
        >
      <label for="toggle-all"></label>
      <ul class="todo-list">
        <li 
          v-for="(todo,index) in filteredTodos"
          :key="index"
          class="todo"
          :class="{ completed: todo.done, editing: editing }"
        >
          <div class="view">
            <input 
              :checked="todo.done"
              class="toggle"
              type="checkbox"
              @change="toggleTodo( todo)"
            >
            <label v-text="todo.text" @dblclick="editing = true" />
            <button class="destroy" @click="deleteTodo(todo)"/>
          </div>
          <input
            v-show="editing"
            v-focus="editing"
            :value="todo.text"
            class="edit"
            @keyup.enter="doneEdit"
            @keyup.esc="cancelEdit"
            @blur="doneEdit"
          >                
        </li>
      </ul>
    </section>
    <!-- footer -->
    <footer v-show="todos.length" class="footer">
      <span class="todo-count">
        <strong>{{ remaining }}</strong>
        {{ remaining | pluralize('item') }} left
      </span>
      <ul class="filters">
        <li v-for="(val, key) in filters" :key="key">
          <a :class="{ selected: visibility === key }" @click.prevent="visibility = key">{{ key | capitalize }}</a>
        </li>
      </ul>
      <button class="clear-completed" v-show="todos.length > remaining" @click="clearCompleted">
        Clear completed
      </button>
    </footer>
  </section>
</template>


<script>
const STORAGE_KEY = 'todos'
const filters = {
  all: todos => todos,
  active: todos => todos.filter(todo => !todo.done),
  completed: todos => todos.filter(todo => todo.done)
}
const defalutList = [
  { text: 'star this repository', done: false },
  { text: 'fork this repository', done: false },
  { text: 'follow author', done: false },
  { text: 'vue-element-admin', done: true },
  { text: 'vue', done: true },
  { text: 'element-ui', done: true },
  { text: 'axios', done: true },
  { text: 'webpack', done: true }
]
export default {
  directives: {
    focus(el, { value }, { context }) {
      if (value) {
        context.$nextTick(() => {
          el.focus()
        })
      }
    }
  },
  filters: {
    // 当事件数量为1时，单词不加s,反之加s
    pluralize: (n, w) => n === 1 ? w : w + 's',
    // 单词第一位变成大写字母
    capitalize: s => s.charAt(0).toUpperCase() + s.slice(1)
  },
  data() {
    return {
      visibility: 'all',
      filters,
      todos: defalutList,
      editing: false
    }
  },
  computed: {
    /**
     * every() 方法用于检测数组所有元素是否都符合指定条件（通过函数提供）。
      every() 方法使用指定函数检测数组中的所有元素：

      如果数组中检测到有一个元素不满足，则整个表达式返回 false ，且剩余的元素不会再进行检测。
      如果所有元素都满足条件，则返回 true。
      注意： every() 不会对空数组进行检测。
      注意： every() 不会改变原始数组。
     */
    allChecked() {
      return this.todos.every(todo => todo.done)
    },
    filteredTodos() {
      return filters[this.visibility](this.todos)
    },
    remaining() {
      return this.todos.filter(todo => !todo.done).length
    }
  },
  methods: {
    // 将事件存储在本地
    setLocalStorage() {
      // JSON.stringify() 一个 JavaScript 对象或值转换为 JSON 字符串
      window.localStorage.setItem(STORAGE_KEY, JSON.stringify(this.todos))
    },
    // 添加待办事件
    addTodo(e) {
      const text = e.target.value
      if (text.trim()) {
        this.todos.push({
          text,
          done: false
        })
        this.setLocalStorage()
      }
      e.target.value = ''
    },
    // 单个事件切换选中
    toggleTodo(val) {
      console.log(val);
      val.done = !val.done
      this.setLocalStorage()
    },
    deleteTodo(todo) {
      this.todos.splice(this.todos.indexOf(todo), 1)
      this.setLocalStorage()
    },
    editTodo({ todo, value }) {
      todo.text = value
      this.setLocalStorage()
    },
    clearCompleted() {
      this.todos = this.todos.filter(todo => !todo.done)
      this.setLocalStorage()
    },
    // 切换所有选中（未选中）
    toggleAll({ done }) {
      this.todos.forEach(todo => {
        todo.done = done
        this.setLocalStorage()
      })
    },
    doneEdit(e) {
      const value = e.target.value.trim()
      const { todo } = this
      if (!value) {
        this.deleteTodo({
          todo
        })
      } else if (this.editing) {
        this.editTodo({
          todo,
          value
        })
        this.editing = false
      }
    },
    cancelEdit(e) {
      e.target.value = this.todo.text
      this.editing = false
    }
  }
}
</script>

<style lang="scss">
  @import '../dashboard/admin/components/TodoList/index.scss';
</style>
```

vscode 压缩代码方式:选中想要合并的行，按Ctrl + Shift + P调出命令窗口，输入join lines,确认执行就可以合并多行了	